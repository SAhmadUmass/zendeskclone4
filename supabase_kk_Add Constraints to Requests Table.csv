"schemaname","tablename","policyname","permissive","roles","cmd","check_expression","with_check"
"public","messages","Customers can view their own request messages","PERMISSIVE","{public}","SELECT","(EXISTS ( SELECT 1\n   FROM requests\n  WHERE ((requests.id = messages.request_id) AND (requests.customer_id = auth.uid()))))",""
"public","messages","Support staff can view all messages","PERMISSIVE","{public}","SELECT","(EXISTS ( SELECT 1\n   FROM auth.users\n  WHERE ((users.id = auth.uid()) AND ((users.raw_user_meta_data ->> 'role'::text) = 'support'::text))))",""
"public","messages","Customers can insert messages on their requests","PERMISSIVE","{public}","INSERT","","((EXISTS ( SELECT 1\n   FROM requests\n  WHERE ((requests.id = messages.request_id) AND (requests.customer_id = auth.uid())))) AND (sender_type = 'customer'::text) AND (sender_id = auth.uid()))"
"public","requests","Create requests","PERMISSIVE","{public}","INSERT","","(customer_id = auth.uid())"
"public","messages","View messages","PERMISSIVE","{public}","SELECT","((sender_id = auth.uid()) OR (EXISTS ( SELECT 1\n   FROM requests\n  WHERE ((requests.id = messages.request_id) AND (requests.customer_id = auth.uid())))) OR (EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'support'::text)))))",""
"public","messages","Support staff can insert messages","PERMISSIVE","{public}","INSERT","","((EXISTS ( SELECT 1\n   FROM auth.users\n  WHERE ((users.id = auth.uid()) AND ((users.raw_user_meta_data ->> 'role'::text) = 'support'::text)))) AND (sender_type = 'support'::text) AND (sender_id = auth.uid()))"
"public","requests","Support staff can view all requests","PERMISSIVE","{public}","SELECT","(EXISTS ( SELECT 1\n   FROM auth.users\n  WHERE ((users.id = auth.uid()) AND ((users.raw_user_meta_data ->> 'role'::text) = 'support'::text))))",""
"public","profiles","View own profile","PERMISSIVE","{public}","SELECT","(auth.uid() = id)",""
"public","profiles","Support view all profiles","PERMISSIVE","{public}","SELECT","((id = auth.uid()) AND (role = 'support'::text))",""
"public","requests","Support staff can update assigned tickets","PERMISSIVE","{public}","UPDATE","((assigned_to = auth.uid()) OR (EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'support'::text)))))",""
"public","requests","Customers view own requests","PERMISSIVE","{public}","SELECT","(customer_id = auth.uid())",""
"public","requests","Support staff view all requests","PERMISSIVE","{public}","SELECT","(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'support'::text))))",""